```c++
#include <iostream>
using namespace std;


int cube[4][4];
bool ok[4][4];

int n = 4;

bool go(int index, int cnt) { // 인덱스가 0부터 끝까지 이동.
    if (index == 16) { // 끝까지 왔다면
        for(int i=0; i < n; i++){
            for(int j=0; j < n; j++){
                cout << cube[i][j] << " ";
            }
            cout << "\n";
        }
        cout << cnt << " ";
        return true; // 성공했다는 true 반환
    }
    int x = index/n; // 현재 x 세로
    int y = index%n; // 현재 y 가로
    if (cube[x][y] == index+1) ok[x][y] = true;
    if (ok[x][y] == true) { // 빈칸이 아니라면
        return go(index+1, cnt); // 다음으로 넘어가라 -> 끝까지 갔다면 true가 나오고 아니면 false 가 반환
    } else {
        if(ok[x][0] == false && ok[x][1] == false && ok[x][2] == false && ok[x][3] == false){
            int temp = cube[x][3];
            for(int j=3; j > 0; j--){
                cube[x][j] = cube[x][j-1];
            }
            cube[x][0] = temp;
            if(go(index, cnt+1)) return true;

            temp = cube[x][0];
            for(int j=0; j < 3; j++){
                cube[x][j] = cube[x][j+1];
            }
            cube[x][3] = temp;
        }
        if(ok[0][y] == false && ok[1][y] == false && ok[2][y] == false && ok[3][y] == false){
            int temp = cube[3][y];
            for(int j=3; j > 0; j--){
                cube[j][y] = cube[j-1][y];
            }
            cube[0][y] = temp;
            if(go(index, cnt+1)) return true;
            temp = cube[0][y];
            for(int j=0; j < 3; j++){
                cube[j][y] = cube[j+1][y];
            }
            cube[3][y] = temp;
        }
    }
    return false;
}
// 아래 오른쪽이네

int main() {
    for (int i=0; i<n; i++) {
        for (int j=0; j<n; j++) {
            cin >> cube[i][j];
            if(cube[i][j] == (i*4)+j+1) ok[i][j] = true;
        }
    }
    
    go(0, 0);
    return 0;
}

```
