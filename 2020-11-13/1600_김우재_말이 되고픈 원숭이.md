```c++
#include <iostream>
#include <string>
#include <queue>
#include <tuple>

using namespace std;

int dx[] = {0,0,1,-1};
int dy[] = {1,-1,0,0};

int hores_x[] = {1, -1, 2, 2, -2, -2, 1, -1};
int hores_y[] = {2, 2, 1, -1, 1, -1, -2, -2};

int main(void) {
    int k; cin >> k;
    int width, height;
    cin >> width >> height;
    vector<vector<int>> map(height, vector<int> (width, 0));
    
    for(int i=0; i < height; i++){
        for(int j=0; j < width; j++){
            cin >> map[i][j];
        }
    }
    // 왼쪽 위에서 아래로
    // 내가 봤을 때는 차원을 이용해야 할 것 같음
    int pass[31][200][200];
    for(int i=0; i < 31; i++){
        for(int j=0; j < 200; j++){
            for(int k=0; k < 200; k++){
                pass[i][j][k] = -1;
            }
        }
    }
    pass[0][0][0] = 0;
    queue<tuple<int, int ,int>> q;
    q.push(make_tuple(0,0,0));
    
    while (!q.empty()) {
        int count = get<0>(q.front());
        int now_x = get<1>(q.front());
        int now_y = get<2>(q.front());
        q.pop();
        for(int i=0; i < 4; i++){
            int nx = now_x + dx[i];
            int ny = now_y + dy[i];
            if(nx >= 0 && nx < height && ny >= 0 && ny < width && map[nx][ny] != 1){
                if(pass[count][nx][ny] == -1 || pass[count][nx][ny] > pass[count][now_x][now_y]+1){
                    pass[count][nx][ny] = pass[count][now_x][now_y]+1;
                    q.push(make_tuple(count, nx, ny));
                }
            }
        }
        if(count < k){
            for(int i=0; i < 8; i++){
                int nx = now_x + hores_x[i];
                int ny = now_y + hores_y[i];
                if(nx >= 0 && nx < height && ny >= 0 && ny < width && map[nx][ny] != 1){
                    if(pass[count+1][nx][ny] == -1 || pass[count+1][nx][ny] > pass[count][now_x][now_y]+1){
                        pass[count+1][nx][ny] = pass[count][now_x][now_y]+1;
                        q.push(make_tuple(count+1, nx, ny));
                    }
                }
            }
        }
    }
    int answer = 999999;
    bool flag = true;
    for(int i=0; i <= k; i++){
        if(pass[i][height-1][width-1] != -1){
            flag = false;
            answer = min(answer, pass[i][height-1][width-1]);
        }
    }
    if(flag) answer = -1;
    cout << answer << "\n";
    return 0;
}
```
